{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {
      "url": "https://raw.githubusercontent.com/smanve/2-assign/main/data/filtered_data_2020.csv"
    },
    "width": 700,
    "height": 400,
    "params": [
      {
        "name": "Continent_selection",
        "bind": {
          "input": "select",
          "options": [
            null,
            "Africa",
            "Asia",
            "Europe",
            "North America",
            "Oceania",
            "South America"
          ],
          "labels": [
            "Show All",
            "Africa",
            "Asia",
            "Europe",
            "North America",
            "Oceania",
            "South America"
          ],
          "name": "Select Continent: "
        }
      }
    ],
    "transform": [
      {
        "filter": "isValid(datum.Continent) && (Continent_selection == null || datum.Continent == Continent_selection)"
      },
      {
        "filter": "isValid(datum['Access to electricity (% of population)']) && isValid(datum['Access to clean fuels for cooking']) && isValid(datum['Renewable-electricity-generating-capacity-per-capita']) && isValid(datum['Low-carbon electricity (% electricity)']) && isValid(datum['Primary energy consumption per capita (kWh/person)'])"
      },
      {
        "fold": [
          "Renewable-electricity-generating-capacity-per-capita",
          "Primary energy consumption per capita (kWh/person)"
        ]
      },
      {
        "joinaggregate": [
          {"op": "min", "field": "value", "as": "min"},
          {"op": "max", "field": "value", "as": "max"}
        ],
        "groupby": ["key"]
      },
      {
        "filter": "datum.min !== datum.max"
      },
      {
        "calculate": "(datum.value - datum.min) / (datum.max - datum.min)",
        "as": "norm_val"
      },
      {
        "fold": [
          "Access to electricity (% of population)",
          "Access to clean fuels for cooking",
          "Low-carbon electricity (% electricity)"
        ],
        "as": ["key", "value"]
      },
      {
        "calculate": "datum.key !== 'Access to electricity (% of population)' && datum.key !== 'Access to clean fuels for cooking' && datum.key !== 'Low-carbon electricity (% electricity)' ? datum.norm_val * 100 : datum.value",
        "as": "final_val"
      }
    ],
    "layer": [
      {
        "mark": {"type": "rule", "color": "#ccc"},
        "encoding": {
          "x": {"type": "ordinal", "field": "key", "sort": null}
        }
      },
      {
        "mark": "line",
        "encoding": {
          "color": {
            "type": "nominal",
            "field": "Continent",
            "legend": {"title": "Continent"},
            "scale": {
              "domain": [
                "Africa",
                "Asia",
                "Europe",
                "North America",
                "Oceania",
                "South America"
              ]
            }
          },
          "detail": {"type": "nominal", "field": "Entity"},
          "x": {"type": "ordinal", "field": "key", "sort": null},
          "y": {"type": "quantitative", "field": "final_val", "scale": {"domain": [0, 100]}, "axis": {"format": "%"}},
          "opacity": {"value": 0.7}
        }
      }
    ],
    "config": {"axisY": {"grid": false, "title": null}, "axisX": {"labelFontSize": 12}}
  }
  